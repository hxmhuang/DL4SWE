This branch is written by Zheng Fang. 
